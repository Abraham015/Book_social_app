import{$ as ke,B as F,C as f,D as u,E as Ce,F as ve,G as _e,H as ee,I as c,J as M,L as x,M as R,N as S,O as w,Q as te,R as be,S as E,T as O,U as ye,V as P,W as Ae,X as xe,Y as Re,Z as Se,_ as we,a as J,b as pe,ba as Ie,c as C,ca as T,d as I,e as ce,ea as Fe,f as le,g as ue,h as Y,ha as D,i as de,ia as N,j as v,k as me,l as fe,la as j,m as b,n as y,o as X,oa as B,pa as Me,q as l,qa as ie,r as m,ra as Ee,s as h,sa as Oe,t as ge,ta as H,u as d,ua as W,v as he,va as Pe,w as s,x as a,y as _}from"./chunk-5UUBOFLI.js";var oe=J(ie());function $(i,r,e,t){let o=new H(r,$.PATH,"get");return e&&o.query("token",e.token,{}),i.request(o.build({responseType:"json",accept:"application/json",context:t})).pipe(I(n=>n instanceof P),C(n=>n))}$.PATH="/auth/activate-account";function z(i,r,e,t){let o=new H(r,z.PATH,"post");return e&&o.body(e.body,"application/json"),i.request(o.build({responseType:"json",accept:"application/json",context:t})).pipe(I(n=>n instanceof P),C(n=>n))}z.PATH="/auth/authenticate";function K(i,r,e,t){let o=new H(r,K.PATH,"post");return e&&o.body(e.body,"application/json"),i.request(o.build({responseType:"json",accept:"application/json",context:t})).pipe(I(n=>n instanceof P),C(n=>n))}K.PATH="/auth/register";var k=class i extends Oe{constructor(r,e){super(r,e)}static RegisterPath="/auth/register";register$Response(r,e){return K(this.http,this.rootUrl,r,e)}register(r,e){return this.register$Response(r,e).pipe(C(t=>t.body))}static AuthenticatePath="/auth/authenticate";authenticate$Response(r,e){return z(this.http,this.rootUrl,r,e)}authenticate(r,e){return this.authenticate$Response(r,e).pipe(C(t=>t.body))}static ActiveAccountPath="/auth/activate-account";activeAccount$Response(r,e){return $(this.http,this.rootUrl,r,e)}activeAccount(r,e){return this.activeAccount$Response(r,e).pipe(C(t=>t.body))}static \u0275fac=function(e){return new(e||i)(Y(Ee),Y(Ae))};static \u0275prov=ce({token:i,factory:i.\u0275fac,providedIn:"root"})};function We(i,r){if(i&1&&(s(0,"p"),c(1),a()),i&2){let e=r.$implicit;l(),M(e)}}function $e(i,r){if(i&1&&(s(0,"div",11),h(1,We,2,1,"p",12),a()),i&2){let e=u();l(),d("ngForOf",e.errorMsg)}}var Q=class i{constructor(r,e,t){this.router=r;this.authService=e;this.tokenService=t}authRequest={email:"",password:""};errorMsg=[];login(){this.errorMsg=[],this.authService.authenticate({body:this.authRequest}).subscribe({next:r=>{this.tokenService.token=r.data,this.router.navigate(["books"])},error:r=>{console.log(r.error.validationErrors),r.error.validationErrors?oe.default.fire({title:"Error!",text:r.error.validationErrors,icon:"error",confirmButtonText:"Ok"}):oe.default.fire({title:"Error!",text:"Email and / or Password is incorrect",icon:"error",confirmButtonText:"Ok"})}})}register(){this.router.navigate(["register"])}static \u0275fac=function(e){return new(e||i)(m(T),m(k),m(W))};static \u0275cmp=v({type:i,selectors:[["app-login"]],standalone:!0,features:[w],decls:22,vars:3,consts:[[1,"container-fluid","card","login-container"],[1,"text-center"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"mb-3"],[1,"form-label"],["type","email","id","login","placeholder","name@example.com",1,"form-control",3,"ngModelChange","ngModel"],["type","password","id","password","placeholder","password",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-between","mb-3"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-sign-in-alt"],["type","button",1,"btn","btn-link",3,"click"],["role","alert",1,"alert","alert-danger"],[4,"ngFor","ngForOf"]],template:function(e,t){e&1&&(s(0,"div",0)(1,"h3",1),c(2,"Login"),a(),_(3,"hr"),h(4,$e,2,1,"div",2),s(5,"div",3)(6,"label",4),c(7,"Email address"),a(),s(8,"input",5),S("ngModelChange",function(n){return R(t.authRequest.email,n)||(t.authRequest.email=n),n}),a()(),s(9,"div",3)(10,"label",4),c(11,"Password"),a(),s(12,"input",6),S("ngModelChange",function(n){return R(t.authRequest.password,n)||(t.authRequest.password=n),n}),a()(),s(13,"div",7)(14,"button",8),f("click",function(){return t.login()}),_(15,"em",9),c(16," \xA0 Sign in "),a(),s(17,"div"),c(18," Don't have an account? \xA0 "),s(19,"button",10),f("click",function(){return t.register()}),_(20,"em",9),c(21," \xA0 Register "),a()()()()),e&2&&(l(4),d("ngIf",t.errorMsg.length),l(4),x("ngModel",t.authRequest.email),l(4),x("ngModel",t.authRequest.password))},dependencies:[B,D,N,j,O,E]})};var se=J(ie());function ze(i,r){if(i&1&&(s(0,"p"),c(1),a()),i&2){let e=r.$implicit;l(),M(e)}}function Ke(i,r){if(i&1&&(s(0,"div",13),h(1,ze,2,1,"p",14),a()),i&2){let e=u();l(),d("ngForOf",e.errorMsg)}}var U=class i{constructor(r,e){this.router=r;this.authService=e}registerRequest={email:"",firstName:"",lastName:"",password:""};errorMsg=[];login(){this.router.navigate(["login"])}register(){this.errorMsg=[],this.authService.register({body:this.registerRequest}).subscribe({next:()=>{se.default.fire({icon:"success",title:"User created successfully",confirmButtonText:"Ok"}).then(()=>this.router.navigate(["activate-account"]))},error:r=>{se.default.fire({title:"Error!",html:`
              ${r.error.validationErrors.join("<br>")}
            `,icon:"error",confirmButtonText:"Ok"})}})}static \u0275fac=function(e){return new(e||i)(m(T),m(k))};static \u0275cmp=v({type:i,selectors:[["app-register"]],standalone:!0,features:[w],decls:30,vars:5,consts:[[1,"container-fluid","card","login-container"],[1,"text-center"],["class","alert alert-danger","role","alert",4,"ngIf"],[1,"mb-3"],[1,"form-label"],["type","email","id","firstname","placeholder","John",1,"form-control",3,"ngModelChange","ngModel"],["type","email","id","lastname","placeholder","John",1,"form-control",3,"ngModelChange","ngModel"],["type","email","id","login","placeholder","name@example.com",1,"form-control",3,"ngModelChange","ngModel"],["type","password","id","password","placeholder","password",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","justify-content-between","mb-3"],["type","button",1,"btn","btn-primary",3,"click"],[1,"fas","fa-sign-in-alt"],["type","button",1,"btn","btn-link",3,"click"],["role","alert",1,"alert","alert-danger"],[4,"ngFor","ngForOf"]],template:function(e,t){e&1&&(s(0,"div",0)(1,"h3",1),c(2,"Create an account"),a(),_(3,"hr"),h(4,Ke,2,1,"div",2),s(5,"div",3)(6,"label",4),c(7,"First Name"),a(),s(8,"input",5),S("ngModelChange",function(n){return R(t.registerRequest.firstName,n)||(t.registerRequest.firstName=n),n}),a()(),s(9,"div",3)(10,"label",4),c(11,"Last Name"),a(),s(12,"input",6),S("ngModelChange",function(n){return R(t.registerRequest.lastName,n)||(t.registerRequest.lastName=n),n}),a()(),s(13,"div",3)(14,"label",4),c(15,"Email address"),a(),s(16,"input",7),S("ngModelChange",function(n){return R(t.registerRequest.email,n)||(t.registerRequest.email=n),n}),a()(),s(17,"div",3)(18,"label",4),c(19,"Password"),a(),s(20,"input",8),S("ngModelChange",function(n){return R(t.registerRequest.password,n)||(t.registerRequest.password=n),n}),a()(),s(21,"div",9)(22,"button",10),f("click",function(){return t.register()}),_(23,"em",11),c(24," \xA0 Register "),a(),s(25,"div"),c(26," Already have an account? \xA0 "),s(27,"button",12),f("click",function(){return t.login()}),_(28,"em",11),c(29," \xA0 Login "),a()()()()),e&2&&(l(4),d("ngIf",t.errorMsg.length),l(4),x("ngModel",t.registerRequest.firstName),l(4),x("ngModel",t.registerRequest.lastName),l(4),x("ngModel",t.registerRequest.email),l(4),x("ngModel",t.registerRequest.password))},dependencies:[E,O,Me,D,N,B,j]})};var Qe=["input"];function Ue(i,r){if(i&1){let e=F();s(0,"span")(1,"input",2,0),f("click",function(o){b(e);let n=u();return y(n.onClick(o))})("paste",function(o){let n=b(e).index,p=u();return y(p.onPaste(o,n))})("input",function(o){let n=b(e).index,p=u();return y(p.onInput(o,n))})("keydown",function(o){let n=b(e).index,p=u();return y(p.onKeydown(o,n))}),a()()}if(i&2){let e=u();he("code-hidden",e.isCodeHidden),l(),d("type",e.inputType)("disabled",e.disabled),ge("inputmode",e.inputMode)("autocapitalize",e.autocapitalize)}}var Le=new ue("CodeInputComponentConfig"),He={codeLength:4,inputType:"tel",inputMode:"numeric",initialFocusField:void 0,isCharsCode:!1,isCodeHidden:!1,isPrevFocusableAfterClearing:!0,isFocusingOnLastByClickIfFilled:!1,code:void 0,disabled:!1,autocapitalize:void 0},L=function(i){return i[i.ready=0]="ready",i[i.reset=1]="reset",i}(L||{}),Ve=(()=>{class i{constructor(e){if(this.isNonDigitsCode=!1,this.codeChanged=new X,this.codeCompleted=new X,this.placeholders=[],this.inputs=[],this.inputsStates=[],this.state={isFocusingAfterAppearingCompleted:!1,isInitialFocusFieldEnabled:!1},Object.assign(this,He),!!e)for(let t in e)e.hasOwnProperty(t)&&He.hasOwnProperty(t)&&(this[t]=e[t])}ngOnInit(){this.state.isInitialFocusFieldEnabled=!this.isEmpty(this.initialFocusField),this.onCodeLengthChanges()}ngAfterViewInit(){this.inputsListSubscription=this.inputsList.changes.subscribe(this.onInputsListChanges.bind(this)),this.onInputsListChanges(this.inputsList)}ngAfterViewChecked(){this.focusOnInputAfterAppearing()}ngOnChanges(e){e.code&&this.onInputCodeChanges(),e.codeLength&&this.onCodeLengthChanges()}ngOnDestroy(){this.inputsListSubscription&&this.inputsListSubscription.unsubscribe()}reset(e=!1){this.onInputCodeChanges(),this.state.isInitialFocusFieldEnabled&&this.focusOnField(this.initialFocusField),e&&this.emitChanges()}focusOnField(e){if(e>=this._codeLength)throw new Error("The index of the focusing input box should be less than the codeLength.");this.inputs[e].focus()}onClick(e){if(!this.isFocusingOnLastByClickIfFilled)return;let t=e.target,o=this.inputs[this._codeLength-1];t===o||!(this.getCurrentFilledCode().length>=this._codeLength)||setTimeout(()=>o.focus())}onInput(e,t){let o=e.target,n=e.data||o.value;if(this.isEmpty(n))return;if(!this.canInputValue(n)){e.preventDefault(),e.stopPropagation(),this.setInputValue(o,null),this.setStateForInput(o,L.reset);return}let p=n.toString().trim().split("");for(let g=0;g<p.length;g++){let V=g+t;if(V>this._codeLength-1)break;this.setInputValue(this.inputs[V],p[g])}this.emitChanges();let A=t+p.length;if(A>this._codeLength-1){o.blur();return}this.inputs[A].focus()}onPaste(e,t){e.preventDefault(),e.stopPropagation();let o=e.clipboardData?e.clipboardData.getData("text").trim():void 0;if(this.isEmpty(o))return;let n=o.split(""),p=0;for(let A=t;A<this.inputs.length&&p!==n.length;A++){let g=this.inputs[A],V=n[p];if(!this.canInputValue(V)){this.setInputValue(g,null),this.setStateForInput(g,L.reset);return}this.setInputValue(g,V.toString()),p++}this.inputs[t].blur(),this.emitChanges()}onKeydown(e,t){return pe(this,null,function*(){let o=e.target,n=this.isEmpty(o.value),p=t-1,A=yield this.isBackspaceKey(e),g=this.isDeleteKey(e);!A&&!g||(e.preventDefault(),this.setInputValue(o,null),n||this.emitChanges(),!(p<0||g)&&(n||this.isPrevFocusableAfterClearing)&&this.inputs[p].focus())})}onInputCodeChanges(){if(!this.inputs.length)return;if(this.isEmpty(this.code)){this.inputs.forEach(o=>{this.setInputValue(o,null)});return}let e=this.code.toString().trim().split(""),t=!0;for(let o of e)if(!this.canInputValue(o)){t=!1;break}this.inputs.forEach((o,n)=>{let p=t?e[n]:null;this.setInputValue(o,p)})}onCodeLengthChanges(){if(this.codeLength)if(this._codeLength=this.codeLength,this._codeLength>this.placeholders.length){let e=Array(this._codeLength-this.placeholders.length).fill(1);this.placeholders.splice(this.placeholders.length-1,0,...e)}else this._codeLength<this.placeholders.length&&this.placeholders.splice(this._codeLength)}onInputsListChanges(e){if(e.length>this.inputs.length){let t=e.filter((n,p)=>p>this.inputs.length-1);this.inputs.splice(this.inputs.length,0,...t.map(n=>n.nativeElement));let o=Array(t.length).fill(L.ready);this.inputsStates.splice(this.inputsStates.length,0,...o)}else e.length<this.inputs.length&&(this.inputs.splice(e.length),this.inputsStates.splice(e.length));this.onInputCodeChanges()}focusOnInputAfterAppearing(){this.state.isInitialFocusFieldEnabled&&(this.state.isFocusingAfterAppearingCompleted||(this.focusOnField(this.initialFocusField),this.state.isFocusingAfterAppearingCompleted=document.activeElement===this.inputs[this.initialFocusField]))}emitChanges(){setTimeout(()=>this.emitCode(),50)}emitCode(){let e=this.getCurrentFilledCode();this.codeChanged.emit(e),e.length>=this._codeLength&&this.codeCompleted.emit(e)}getCurrentFilledCode(){let e="";for(let t of this.inputs)this.isEmpty(t.value)||(e+=t.value);return e}isBackspaceKey(e){return e.key&&e.key.toLowerCase()==="backspace"||e.keyCode&&e.keyCode===8?Promise.resolve(!0):!e.keyCode||e.keyCode!==229?Promise.resolve(!1):new Promise(o=>{setTimeout(()=>{let n=e.target,p=this.getStateForInput(n)===L.reset;p&&this.setStateForInput(n,L.ready),o(n.selectionStart===0&&!p)})})}isDeleteKey(e){return e.key&&e.key.toLowerCase()==="delete"||e.keyCode&&e.keyCode===46}setInputValue(e,t){let o=this.isEmpty(t),n="has-value",p="empty";o?(e.value="",e.classList.remove(n),e.parentElement.classList.add(p)):(e.value=t,e.classList.add(n),e.parentElement.classList.remove(p))}canInputValue(e){return this.isEmpty(e)?!1:/^[0-9]+$/.test(e.toString())||this.isCharsCode||this.isNonDigitsCode}setStateForInput(e,t){let o=this.inputs.indexOf(e);o<0||(this.inputsStates[o]=t)}getStateForInput(e){let t=this.inputs.indexOf(e);return this.inputsStates[t]}isEmpty(e){return e==null||!e.toString().length}static{this.\u0275fac=function(t){return new(t||i)(m(Le,8))}}static{this.\u0275cmp=v({type:i,selectors:[["code-input"]],viewQuery:function(t,o){if(t&1&&Ce(Qe,5),t&2){let n;ve(n=_e())&&(o.inputsList=n)}},inputs:{codeLength:"codeLength",inputType:"inputType",inputMode:"inputMode",initialFocusField:"initialFocusField",isNonDigitsCode:"isNonDigitsCode",isCharsCode:"isCharsCode",isCodeHidden:"isCodeHidden",isPrevFocusableAfterClearing:"isPrevFocusableAfterClearing",isFocusingOnLastByClickIfFilled:"isFocusingOnLastByClickIfFilled",code:"code",disabled:"disabled",autocapitalize:"autocapitalize"},outputs:{codeChanged:"codeChanged",codeCompleted:"codeCompleted"},features:[fe],decls:1,vars:1,consts:[["input",""],[3,"code-hidden",4,"ngFor","ngForOf"],["autocomplete","one-time-code",3,"click","paste","input","keydown","type","disabled"]],template:function(t,o){t&1&&h(0,Ue,3,6,"span",1),t&2&&d("ngForOf",o.placeholders)},dependencies:[E],styles:["[_nghost-%COMP%]{--text-security-type: disc;--item-spacing: 4px;--item-height: 4.375em;--item-border: 1px solid #dddddd;--item-border-bottom: 1px solid #dddddd;--item-border-has-value: 1px solid #dddddd;--item-border-bottom-has-value: 1px solid #dddddd;--item-border-focused: 1px solid #dddddd;--item-border-bottom-focused: 1px solid #dddddd;--item-shadow-focused: 0px 1px 5px rgba(221, 221, 221, 1);--item-border-radius: 5px;--item-background: transparent;--item-font-weight: 300;--color: #171516;display:flex;transform:translateZ(0);font-size:inherit;color:var(--color)}[_nghost-%COMP%]   span[_ngcontent-%COMP%]{display:block;flex:1;padding-right:var(--item-spacing)}[_nghost-%COMP%]   span[_ngcontent-%COMP%]:first-child{padding-left:var(--item-spacing)}[_nghost-%COMP%]   span.code-hidden[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{text-security:var(--text-security-type);-webkit-text-security:var(--text-security-type);-moz-text-security:var(--text-security-type)}[_nghost-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:var(--item-height);color:inherit;background:var(--item-background);text-align:center;font-size:inherit;font-weight:var(--item-font-weight);border:var(--item-border);border-bottom:var(--item-border-bottom);border-radius:var(--item-border-radius);-webkit-appearance:none;transform:translateZ(0);-webkit-transform:translate3d(0,0,0);outline:none}[_nghost-%COMP%]   input.has-value[_ngcontent-%COMP%]{border:var(--item-border-has-value);border-bottom:var(--item-border-bottom-has-value)}[_nghost-%COMP%]   input[_ngcontent-%COMP%]:focus{border:var(--item-border-focused);border-bottom:var(--item-border-bottom-focused);box-shadow:var(--item-shadow-focused)}"]})}}return i})(),qe=(()=>{class i{static forRoot(e){return{ngModule:i,providers:[{provide:Le,useValue:e}]}}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275mod=me({type:i})}static{this.\u0275inj=le({imports:[ye]})}}return i})();var ae=J(ie());function Ge(i,r){if(i&1){let e=F();s(0,"div",5)(1,"h2"),c(2,"Activation successful!"),a(),s(3,"p"),c(4,"Your account has been successfully activated!"),a(),s(5,"button",6),f("click",function(){b(e);let o=u(2);return y(o.redirectToLogin())}),c(6,"Go to Login!"),a()()}}function Je(i,r){if(i&1){let e=F();s(0,"div",7)(1,"h2"),c(2,"Activation failed!"),a(),s(3,"p"),c(4),a(),s(5,"button",6),f("click",function(){b(e);let o=u(2);return y(o.submitted=!1)}),c(6,"Try again"),a()()}if(i&2){let e=u(2);l(4),M(e.message)}}function Ye(i,r){if(i&1&&(s(0,"div",3),h(1,Ge,7,0,"div",4)(2,Je,7,1,"ng-template",null,1,te),a()),i&2){let e=ee(3),t=u();l(),d("ngIf",t.isOkay)("ngIfElse",e)}}function Xe(i,r){if(i&1){let e=F();s(0,"div",3)(1,"div",8)(2,"h2"),c(3,"Type your activation code:"),a(),s(4,"code-input",9),f("codeCompleted",function(o){b(e);let n=u();return y(n.onCodeCompleted(o))}),a()()()}i&2&&(l(4),d("isCodeHidden",!1)("codeLength",6)("code","number"))}var Z=class i{constructor(r,e){this.router=r;this.authService=e}message="";isOkay=!0;submitted=!1;onCodeCompleted(r){this.confirmAccount(r)}redirectToLogin(){this.router.navigate(["login"])}confirmAccount(r){this.authService.activeAccount({token:r}).subscribe({next:()=>{ae.default.fire({icon:"success",title:"Your account has been successfully activated",confirmButtonText:"Ok"}).then(()=>{this.submitted=!0,this.isOkay=!0})},error:()=>{ae.default.fire({title:"Error!",text:"Token has been expired or invalid!",icon:"error",confirmButtonText:"Ok"}).then(()=>{this.submitted=!0,this.isOkay=!1})}})}static \u0275fac=function(e){return new(e||i)(m(T),m(k))};static \u0275cmp=v({type:i,selectors:[["app-activate-account"]],standalone:!0,features:[w],decls:3,vars:2,consts:[["codeForm",""],["activationError",""],["class","container",4,"ngIf","ngIfElse"],[1,"container"],["class","activate-message",4,"ngIf","ngIfElse"],[1,"activate-message"],[1,"btn","btn-primary",3,"click"],[1,"activate-error"],[1,"text-center",2,"width","400px"],[3,"codeCompleted","isCodeHidden","codeLength","code"]],template:function(e,t){if(e&1&&h(0,Ye,4,2,"div",2)(1,Xe,5,3,"ng-template",null,0,te),e&2){let o=ee(2);d("ngIf",t.submitted)("ngIfElse",o)}},dependencies:[O,qe,Ve],styles:[".container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh}.activate-message[_ngcontent-%COMP%], .activate-error[_ngcontent-%COMP%]{text-align:center}.activate-error[_ngcontent-%COMP%]{color:red}"]})};var De=[{path:"login",component:Q},{path:"register",component:U},{path:"activate-account",component:Z},{path:"books",loadChildren:()=>import("./chunk-IZWYZZDS.js").then(i=>i.BookModule),canActivate:[Pe]}];var Ne=(i,r)=>{if(i.url.includes("/auth/register"))return r(i);let t=de(W).token;if(t){let o=i.clone({setHeaders:{Authorization:`Bearer ${t}`}});return r(o)}return r(i)};var je={providers:[be({eventCoalescing:!0}),Fe(De),ke(),xe(Se(),Re([Ne]))]};var G=class i{title="book-social-ui";static \u0275fac=function(e){return new(e||i)};static \u0275cmp=v({type:i,selectors:[["app-root"]],standalone:!0,features:[w],decls:1,vars:0,template:function(e,t){e&1&&_(0,"router-outlet")},dependencies:[Ie]})};we(G,je).catch(i=>console.error(i));
